<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Configuration Schema &#8212; exodus-lambda  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=1fc5d657" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tests" href="../test.html" />
    <link rel="prev" title="origin_request Schemas" href="origin_request-schema.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="configuration-schema">
<h1>Configuration Schema<a class="headerlink" href="#configuration-schema" title="Permalink to this heading">Â¶</a></h1>
<p>This page shows the schema of the exodus-lambda config file,
usually named <code class="docutils literal notranslate"><span class="pre">lambda_config.json</span></code>, in <a class="reference external" href="https://json-schema.org/">JSON schema</a> format
(encoded as YAML).</p>
<p>The latest version of this schema is available in raw form at
<a class="reference external" href="https://release-engineering.github.io/exodus-lambda/lambda_config.yaml">https://release-engineering.github.io/exodus-lambda/lambda_config.yaml</a>.</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span># Schema, in json-schema format, for the primary config file consumed
# by exodus-lambda.

$id: https://release-engineering.github.io/exodus-lambda/lambda_config.yaml

$schema: https://json-schema.org/draft/2020-12/schema

title: exodus-lambda config
description: Primary configuration object for exodus-lambda
type: object

properties:
  table:
    description: DynamoDB table used for content
    $ref: &#39;#/definitions/table&#39;
  config_table:
    description: DynamoDB table used for config
    $ref: &#39;#/definitions/table&#39;
  config_cache_ttl:
    type: integer
    description: &gt;-
      How long, in minutes, to cache config loaded from the config_table
    maximum: 10000
    minimum: 0
  cookie_ttl:
    type: integer
    description: &gt;-
      How long, in minutes, cookies generated by /_/cookie endpoint should last
    maximum: 10000
    minimum: 0

  headers:
    type: object
    properties:
      max_age:
        description: &gt;-
          Value of max-age field (seconds) in Cache-Control headers produced
          for responses dealing with mutable files, such as repo entry points
        maximum: 1000000
        minimum: 0
        type: integer
    additionalProperties: false
    required:
    - max_age

  index_filename:
    type: string
    description: &gt;-
      Basename of index file to be automatically served in response to requests
      for a &quot;directory&quot; listing.
    maxLength: 500
    minLength: 1

  key_id:
    type: string
    description: ID of the signing key used to produce CloudFront signed cookies
    pattern: ^[A-Z0-9]{8,28}$

  lambda_version:
    type: string
    description: &gt;-
      Value returned in X-Exodus-Version header; generally should contain git
      revision and possibly a build timestamp
    maxLength: 500
    minLength: 1

  logging:
    description: &gt;-
      Logging config dict, as used by `logging.dictConfig` in python stdlib
    $ref: &#39;#/definitions/logging&#39;

  secret_arn:
    type: string
    description: ARN of secret in AWS Secrets Manager
    maxLength: 500
    minLength: 1

  secret_region:
    type: string
    description: Region used for connections to Secrets Manager
    $ref: &#39;#/definitions/aws_region&#39;

required:
# In practice, we provide most properties in the config file all the time,
# so we list them as required.
#
# It is possible that the code applies some defaults and so some of
# these aren&#39;t truly required. This was not investigated when the schema
# was written.
#
# If needed, you can remove elements from this list after confirming the
# code can handle their absence.
- table
- config_table
- config_cache_ttl
- cookie_ttl
- headers
- secret_arn
- key_id
- lambda_version
- index_filename
- logging

# No properties should be defined other than those listed above.
additionalProperties: false

# Shared definitions referenced from above schema.
definitions:
  aws_region:
    description: AWS region name (e.g. us-east-1)
    pattern: ^[a-z0-9_\-]{1,30}$
    type: string
  logging:
    description: Dict for logging.dictConfig
    # This is not a definitive schema for logging.dictConfig, we only
    # define a schema supporting the fields we use and with enough
    # detail to catch basic mistakes.
    properties:
      disable_existing_loggers:
        type: boolean
      formatters:
        type: object
      incremental:
        type: boolean
      loggers:
        patternProperties:
          .:
            additionalProperties: false
            properties:
              level:
                enum:
                - INFO
                - DEBUG
                - WARNING
                - ERROR
            required:
            - level
            type: object
        type: object
      version:
        const: 1
    type: object
  table:
    type: object
    description: Config for a DynamoDB table
    properties:
      available_regions:
        type: array
        description: &gt;-
          Regions in which copies of the table are available.

          Order matters; earlier regions are higher priority.
        items:
          $ref: &#39;#/definitions/aws_region&#39;
        minItems: 1
      name:
        type: string
        description: Name of a DynamoDB table
        maxLength: 100
        minLength: 1
    required:
    - name
    - available_regions
    additionalProperties: false
</pre></div>
</div>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">exodus-lambda</a></h1>



<p class="blurb">AWS Lambda functions for Red Hat's Content Delivery Network</p>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../arch.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../function-reference.html">Function Reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../schema-reference.html">Schema Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="origin_request-schema.html">origin_request Schemas</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Configuration Schema</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../test.html">Tests</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://github.com/release-engineering/exodus-lambda">Source</a></li>
    
    <li class="toctree-l1"><a href="genindex.html">Index</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../schema-reference.html">Schema Reference</a><ul>
      <li>Previous: <a href="origin_request-schema.html" title="previous chapter">origin_request Schemas</a></li>
      <li>Next: <a href="../test.html" title="next chapter">Tests</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Red Hat.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/schemas/config-schema.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/release-engineering/exodus-lambda" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>